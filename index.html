<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>PR Monitor</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f7f9fc}
    header{background:#0A2540;color:#fff;padding:14px 18px}
    .wrap{max-width:960px;margin:0 auto;padding:18px}
    .card{background:#fff;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:14px 16px;margin:12px 0}
    .meta{color:#555;font-size:12px}
    .chip{background:#eef2f7;border-radius:10px;padding:3px 8px;margin-right:6px;font-size:12px;display:inline-block}
    a{color:#0A2540;text-decoration:none}
    #err{color:#b00020;margin:8px 0}
  </style>
</head>
<body>
<header><h1>PR Monitor</h1></header>
<div class="wrap">
  <div id="err" style="display:none"></div>
  <div id="list"></div>
</div>
<script>
(async () => {
  try {
    const r = await fetch('/api/get_mentions?limit=50');
    if (!r.ok) throw new Error('HTTP '+r.status);
    const data = await r.json();
    const list = document.getElementById('list');
    list.innerHTML = '';
    for (const m of data) {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <div><a href="${m.link}" target="_blank" rel="noopener">${m.title}</a></div>
        <div class="meta">${m.source} Â· ${new Date(m.published).toLocaleString()}</div>
        <div style="margin-top:6px;">${(m.matched||[]).map(k=>`<span class="chip">${k}</span>`).join('')}</div>`;
      list.appendChild(div);
    }
    if (!data.length) document.getElementById('err').style.display='block',
      document.getElementById('err').textContent='No mentions yet. Run /api/collect once.';
  } catch (e) {
    const el = document.getElementById('err');
    el.style.display='block'; el.textContent = 'Could not load mentions. '+e.message;
  }
})();
</script>
</body>
</html>
